# 7. SQL语言之查询与视图

## 7.1 利用SQL语言表达复杂查询
子查询：出现在WHERE语句中的SELECT。相关子查询、非相关子查询。

- (NOT) IN 子查询
- θ Some 与 θ All 子查询
	- 等价变换：= some(子查询) 等同 in(子查询)、 <>all 等同 not in
- (NOT) EXISTS 子查询
	- 检索学过001号教师主讲的所有课程的所有同学的姓名

## 7.2 利用SQL语言进行结果计算与聚集计算
- 结果计算：select expr 
- 聚集函数：select arfunc()——SUM、COUNT、AVG、MIN、MAX

## 7.3 分组查询与分组过滤
- 分组查询：Group By
- 分组过滤：Having
	- 求不及格课程超过两门的同学的学号
	- 求有两门以上不及格课程同学的学号及其平均成绩

## 7.4 利用SQL语言实现关系代数操作
- 并-交-差的处理：UNION、INTERSECT、EXCEPT
	- 自动删除重复元组：不带ALL，集合的操作。若要保留重复的元组，则要带
ALL，包的操作。
	- 假设子查询1的一个元组出现m次，子查询2的一个元组出现n次
，则该元组在：
		- 子查询1 Union ALL 子查询2 ，出现m + n次
		- 子查询1 Intersect ALL 子查询2 ，出现min(m,n)次
		- 子查询1 Except ALL 子查询2 ，出现max(0, m – n)次
		

- 空值的处理：is (not) null
	- 除is [not] null之外，空值**不满足**任何查找条件
	- 如果null参与算术运算，则该算术表达式的值为null
	- 如果null参与聚集运算，则除count(*)之外其它聚集函数都忽略null
	- 如果null参与比较运算，则结果可视为false。
	
- 内连接、外连接： 表1 [INNER | {LEFT|RIGHT|FULL} [OUTER]] JOIN 表2 {ON 连接条件| USING() | natural}

## 7.5 SQL语言之视图及其应用
- SQL-视图的概念和结构：视图对应外模式的数据，不仅包含外模式，而且包含其E-C映像
- SQL-视图的定义：create view view_name as  
- SQL-视图的使用：from view_name
- SQL-视图的更新：不能更新（聚集函数，unique或distinct，group by，算术表达式，单个表的列无主键）
- SQL-视图的撤销：Drop View

## 7.6 总结
- SubQuery1 UNION SubQuery2语句，其中SubQuery1和SubQuery2查询中相应的列必须以同一顺序出现。**正确** 
- GROUP BY和HAVING子句不能在子查询中使用，这些子句只能用在最后一个查询结束时来总结和排序最后结果集。**错误**
- 假设一个元组在子查询1中出现m次，在子查询2中出现n次，其中m>0,n>0, 则
**该元组在“子查询1  Except  子查询2”中出现0次**； 
- 当某一视图删除后，由该视图导出的其它视图也将自动删除；
- SQL语言中的视图是一种**子模式及子模式到模式的映像；**
- 已知student表中共有50个学生，有45人参加了考试（分数存在SC表中），其中10人不及格。执行以下SQL语句：select * from student where exists (select S# from SC where score<60 )， 可返回**50**条记录。(非相关子查询)
