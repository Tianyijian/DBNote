# 10. 嵌入式SQL语言之动态SQL

## 10.1 动态SQL的概念和作用
- 静态SQL特点：SQL语句在程序中已经按要求写好，只需要把一些参数通过变量(高级语言程序语句中不带冒号) 传送给嵌入式SQL语句即可(嵌入式SQL语句中带冒号)
- 动态SQL特点：SQL语句在程序中动态构造，形成一个字符串，然后再交给DBMS执行，交给DBMS执行时仍旧可以传递变量
- 动态SQL 语句是SQL标准提供的一种语句运行机制

## 10.2 SQL语句的动态构造


## 10.3 动态SQL语句的执行方式
- 立即执行：EXEC SQL EXECUTE IMMEDIATE 
- 预编译执行：PREPARE-EXECURE-USING

## 10.4 数据字典与SQLDA
- 数据字典是系统维护的一些表或视图的集合，存储了数据库中各类对象的定义信息。应用程序员构造动态SQL，数据库管理系统实现算法可能需要其中的信息。
- 数据字典也是存储在磁盘上的关系，有专为内存高效访问设计的特定的数据结构。

## 10.5 ODBC/JDBC简介
- ODBC是一种标准，不同语言的应用程序与不同数据库服务器之间通讯的标准。
- JDBC是一组Java版的应用程序接口API，提供了Java应用程序与数据库服务器的连接和通讯能力。
	- JDBC 使用 java.sql.DriverManager类、 java.sql.Driver 和 java.sql.Connection 接口连接到数据库
	- JDBC是一种用于执行SQL语句的Java API 的面向对象的应用程序接口
	- 应用程序使用JDBC API访问数据库的具体实施过程有4步：
		
			(1) 传递一个Driver给DriverManager，加载数据库驱动；
			(2) 通过URL得到一个Connection对象, 建立数据库连接；
			(3) 创建一个Statement对象(PreparedStatement或CallableStatement)，用来查询或者修改数据库；
			(4) 执行查询并返回一个ResultSet，提取数据到应用程序。
	- **java.sql.Statement**：对特定的数据库执行SQL语句
	- **java.sql.PreparedStatement**：用于执行预编译的SQL语句
	- **java.sql.CallableStatement**：用于执行对数据库内嵌过程的调用
	- **java.sql.ResultSet**：从当前执行的SQL语句中返回结果数据

## 10.6 嵌入式SQL语言-ODBC-JDBC比较
- **嵌入式SQL语言**：建立数据库连接->声明一个游标(游标与SQL语句绑定)->打开游标(执行SQL语句)->循环地获取一条一条记录(**属性与高级语言变量绑定**)->关闭游标->可循环地再打开到关闭游标->断开数据库连接
- **ODBC**:建立数据库连接->请求分配语句句柄(申请内存空间)->用句柄执行SQL(句柄与SQL语句绑定)->**建立高级语言变量与句柄属性的对应**->循环地获取一条一条记录->释放语句句柄->断开数据库连接
- **JDBC**:建立数据库连接->创建语句对象(申请内存空间)->用语句对象执行SQL(语句对象与SQL语句绑定)->返回结果对象->循环地从结果对象获取一条一条记录**并提取对象的属性值传给高级语言变量**->释放语句对象->断开数据库连接
- 建立高级语言变量与属性的绑定:
	- 嵌入式SQL语言：在一条一条地读取记录时(Fetch)建立绑定。
	- ODBC：在开始一条一条地读取记录之前用专门的语句建立绑定。
	- JDBC：一条一条记录的，边绑定，边读取相应的属性值

## 10.7 习题
- DBMS中的数据字典可以**用SQL语言查询**
- 数据字典通常由**DBA使用和维护**
- 数据字典是**DBMS自动创建**的，其内容是DBA使用**DDL**进行数据库/表的定义、更新和撤销时建立的
- **SQLCA**是SQL通讯区，记录着SQL语句被DBMS执行后返回的状态信息；**SQLDA**是SQL描述区，记录着数据库/表等对象的定义信息。

